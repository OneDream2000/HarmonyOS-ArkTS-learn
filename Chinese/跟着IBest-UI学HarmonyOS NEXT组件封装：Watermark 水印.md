# ä¸€ã€å¼•è¨€ï¼šä¸€èµ·æ¥å•ƒæºç ï¼Œè§£é”HarmonyOS NEXTçš„â€œç»„ä»¶å¯†ç â€ï¼  
å˜¿ï¼Œå°ä¼™ä¼´ä»¬ï¼ä»Šå¤©æƒ³å’Œå¤§å®¶èŠä¸€ä¸ªè¶…å®ç”¨çš„å¼€æºé¡¹ç›®â€”â€”**IBest-UI**ï¼Œä¸€ä¸ªä¸“ä¸ºé¸¿è’™ç”Ÿæ€æ‰“é€ çš„è½»é‡çº§UIç»„ä»¶åº“ã€‚å¦‚æœä½ æ­£åœ¨å¼€å‘HarmonyOS NEXTåº”ç”¨ï¼Œä¸€å®šé‡åˆ°è¿‡è¿™äº›ç—›ç‚¹ï¼šé‡å¤é€ è½®å­ã€é€‚é…å¤šç«¯ç•Œé¢è´¹æ—¶è´¹åŠ›ã€æ·±æµ…æ¨¡å¼åˆ‡æ¢éº»çƒ¦â€¦â€¦åˆ«æ€¥ï¼ŒIBest-UIå°±æ˜¯æ¥â€œæ•‘åœºâ€çš„ï¼  

**å®ƒæœ‰å¤šé¦™ï¼Ÿ**  

+ **è½»é‡åˆ°é£èµ·**ï¼šæ ¸å¿ƒä»£ç ç²¾ç®€ï¼Œå¼•å…¥å³ç”¨ï¼Œç»ä¸ç»™ä½ æ·»è´Ÿæ‹…ã€‚  
+ **ä¸»é¢˜éšå¿ƒæ¢**ï¼šæ·±è‰²æ¨¡å¼ï¼Ÿæµ…è‰²æ¨¡å¼ï¼Ÿä¸€è¡Œä»£ç åˆ‡æ¢ï¼Œé€‚é…é¸¿è’™å…ƒæœåŠ¡æ¯«æ— å‹åŠ›ã€‚  
+ **åŠŸèƒ½å°è€Œç¾**ï¼šä»æŒ‰é’®åˆ°å¼¹çª—ï¼Œä»å¾½ç« åˆ°å¯¼èˆªæ ï¼Œè¦†ç›–é«˜é¢‘åœºæ™¯ï¼Œæ ·å¼å‚è€ƒvantï¼Œä½¿ç”¨è¿‡vantçš„ï¼Œéƒ½çŸ¥é“vantæ ·å¼æœ‰å¤šå¥½çœ‹ï¼

ä½†ä»Šå¤©å’±ä»¬ä¸å…‰æ˜¯â€œç”¨ç»„ä»¶â€ï¼Œè€Œæ˜¯è¦**æ‰“å¼€å¼•æ“ç›–ï¼Œçœ‹çœ‹é‡Œé¢çš„â€œé»‘ç§‘æŠ€â€**ï¼æˆ‘ä»¬å‘èµ·ä¸€ä¸ª**æºç å…±è¯»è®¡åˆ’**ï¼Œç›®æ ‡å¾ˆç®€å•ï¼š  

1. **æ‹†è§£è®¾è®¡æ€æƒ³**ï¼šæ¯”å¦‚TextEllipsis æ–‡æœ¬çœç•¥ï¼Œå®ƒæ˜¯æ€ä¹ˆå®ç°æ–‡æœ¬çœç•¥çš„ï¼Ÿ  
2. **å·å¸ˆIBest-UI**ï¼šåœ¨æºç ä¸­æ•æ‰ArkTSçš„é«˜é˜¶ç”¨æ³•ï¼Œ<font style="color:rgb(37, 41, 51);">å­¦ä¹ å¦‚ä½•åœ¨HarmonyOS NEXTä¸­ç”¨å£°æ˜å¼UIå¼€å‘â€œä¸æ»‘â€åº”ç”¨ã€‚</font>
3. **è¾¹å­¦è¾¹ç©**ï¼šæ¬¢è¿éšæ—¶æŠ›å‡ºé—®é¢˜ã€æäº¤PRï¼Œå’±ä»¬ä¸€èµ·è®©IBest-UIå˜å¾—æ›´å¼ºå¤§ï¼

æ— è®ºä½ æ˜¯æƒ³æå‡æºç é˜…è¯»èƒ½åŠ›ï¼Œè¿˜æ˜¯æƒ³æ‘¸é€é¸¿è’™å¼€å‘çš„é—¨é“ï¼Œè¿™ä¸ªç³»åˆ—éƒ½ä¼šæ˜¯ä½ çš„â€œå®æˆ˜æŒ‡å—â€ã€‚å‡†å¤‡å¥½å’Œæˆ‘ä¸€èµ·æŒ–å®äº†å—ï¼ŸLetâ€™s goï¼ ğŸš€  

# äºŒã€å‡†å¤‡å·¥ä½œ
<font style="color:rgb(89, 89, 89);">çœ‹ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œç¬¬ä¸€æ­¥åº”è¯¥æ˜¯å…ˆçœ‹</font><font style="color:rgb(89, 89, 89);"> </font>[<font style="color:rgb(3, 106, 202);">README.md</font>](https://github.com/ibestservices/ibest-ui/blob/master/README.md)<font style="color:rgb(89, 89, 89);"> </font><font style="color:rgb(89, 89, 89);">å†çœ‹è´¡çŒ®æ–‡æ¡£</font><font style="color:rgb(89, 89, 89);"> </font>[<font style="color:rgb(3, 106, 202);">github/CONTRIBUTING.md</font>](https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fyouzan%2Fvant%2Fblob%2Fmain%2F.github%2FCONTRIBUTING.md)<font style="color:rgb(89, 89, 89);">ã€‚</font>

1. **å…‹éš†æºç **

```javascript
# å…‹éš†gitalbä»“åº“
git clone git@github.com:ibestservices/ibest-ui.git

# æˆ–è€…å…‹éš†giteeä»“åº“
git clone git@gitee.com:ibestservices/ibest-ui.git

# è¿›å…¥é¡¹ç›®
cd ./ibest-ui

# å®‰è£…ä¾èµ–
ohpm install
```

2. **æŸ¥çœ‹ç›®å½•ç»“æ„**

æ ¹æ®è´¡çŒ®æ–‡æ¡£ï¼Œå¯ä»¥äº†è§£åˆ°ç›®å½•ç»“æ„

```plain
â”œâ”€â”€ entry # ä¾‹å­hapåŒ…
â”‚   â””â”€â”€ src
â”‚   â”œâ”€â”€ main
â”‚   â”‚   â”œâ”€â”€ ets
â”‚   â”‚   â”‚   â”œâ”€â”€ assets
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ styles # ä¾‹å­é¡µé¢æ ·å¼
â”‚   â”‚   â”‚   â”œâ”€â”€ components # ä¾‹å­ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ entryability
â”‚   â”‚   â”‚   â””â”€â”€ pages # ä¾‹å­é¡µé¢
â”‚   â”‚   â””â”€â”€ resources
â”‚   â”‚   â”œâ”€â”€ base
# ...
â”œâ”€â”€ hvigor
â”œâ”€â”€ library  # ç»„ä»¶åº“
â”‚   â””â”€â”€ src
â”‚   â””â”€â”€ main
â”‚   â”œâ”€â”€ ets
â”‚   â”‚   â”œâ”€â”€ assets
â”‚   â”‚   â”‚   â””â”€â”€ ets # å·¥å…·æ–¹æ³•
â”‚   â”‚   â”œâ”€â”€ components # ç»„ä»¶ç›®å½•
â”‚   â”‚   â”‚   â”œâ”€â”€ button
â”‚   â”‚   â”‚   â”œâ”€â”€ cell
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â””â”€â”€ theme-chalk # æ ·å¼å˜é‡
â”‚   â”‚   â””â”€â”€ src
â”‚   â””â”€â”€ resources # ç»„ä»¶åº“èµ„æº
â”‚   â”œâ”€â”€ base
# ...
```

æ ¹æ®ç›®å½•ï¼Œå¯ä»¥äº†è§£åˆ°ï¼Œå¼€å‘çš„ç»„ä»¶ã€ä¿®å¤bugï¼Œä¸»è¦æ˜¯åœ¨<font style="color:rgb(60, 60, 67);"> </font>`<font style="color:rgb(255, 80, 44);background-color:rgb(255, 245, 245);">library</font>` é‡Œè¿›è¡Œå¼€å‘ï¼Œ<font style="color:rgb(60, 60, 67);"> </font>`<font style="color:rgb(255, 80, 44);background-color:rgb(255, 245, 245);">entry/main/ets/pages</font>` é‡Œåšç»„ä»¶ä¾‹å­é¡µé¢ã€‚

å…¨å±€æ ·å¼å˜é‡åœ¨<font style="color:rgb(60, 60, 67);"> </font>`<font style="color:rgb(255, 80, 44);background-color:rgb(255, 245, 245);">library/src/theme-chalk/...</font>`é‡Œå®šä¹‰

# <font style="color:rgb(60, 60, 67);">ä¸‰ã€demo æ¼”ç¤º</font>
å¯ä»¥é€šè¿‡å¿«æ·æ–¹å¼ `Ctrl+Shift+N` è½¬åˆ°æ–‡ä»¶ï¼Œè¾“å…¥è‡ªå·±æ‰€æƒ³æ‰¾åˆ°çš„æ–‡ä»¶

![](https://cdn.nlark.com/yuque/0/2025/png/26122809/1742732392255-1af4e3da-7eb1-44e8-b794-5599af03d933.png)

æ ¹æ®å‰é¢çš„ç›®å½•ç»“æ„ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“äº†entryæ˜¯æ ·ä¾‹æ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦æ‰¾çš„æ–‡ä»¶ï¼Œå°±æ˜¯åœ¨ <font style="color:rgb(60, 60, 67);"> </font>`<font style="color:rgb(255, 80, 44);background-color:rgb(255, 245, 245);">entry\src\main\ets\pages\base\Watermark.ets</font>`é‡Œ

```typescript
import router from '@ohos.router';
import { IBestButton, IBestNavBar, IBestToast, IBestWatermark } from '@ibestservices/ibest-ui';
import { CONTAINER_SIZE, modeColor, SPACE } from '../../assets/styles/BaseStyle';
import ComponentShowContainer from '../../components/ComponentShowContainer';
import { ComponentRouterParams } from '../../assets/global.type';
@Entry
@Component
struct WatermarkPage {
	@State title: string = (router.getParams() as ComponentRouterParams).title || ''
	@Builder
	content() {
		Column({space: SPACE.SM}) {
			Text($r("app.string.app_desc"))
			IBestButton({
				type: "primary",
				text: "æ‰“å¼€å¼¹æ¡†",
				onClickBtn: () => {
					IBestToast.show("ç‚¹å‡»äº†æŒ‰é’®")
				}
			})
		}
		.width(CONTAINER_SIZE.FULL)
		.height(200)
		.padding(20)
		.justifyContent(FlexAlign.Center)
	}
	build() {
		Column() {
			IBestNavBar({
				title: this.title,
				isShowStatusBar: true,
				onLeftClick: () => {
					router.back()
				}
			})
			List() {
				ListItem() {
					ComponentShowContainer({ title: 'æ–‡å­—æ°´å°', titlePaddingLeft: SPACE.XS }) {
						IBestWatermark({
							text: 'IBest-UI',
							gapX: 40,
							gapY: 40
						}) {
							this.content()
						}
					}
				}
				ListItem() {
					ComponentShowContainer({ title: 'å›¾ç‰‡æ°´å°', titlePaddingLeft: SPACE.XS }) {
						Column({space: SPACE.SM}){
							IBestWatermark({
								imageUrl: $r("app.media.app_icon"),
								waterMarkWidth: 40,
								waterMarkHeight: 40,
								gapX: 40,
								gapY: 40,
								rotateDeg: 0
							}) {
								this.content()
							}
							IBestWatermark({
								imageUrl: 'https://fastly.jsdelivr.net/npm/@vant/assets/logo.png',
								waterMarkWidth: 40,
								waterMarkHeight: 40,
								gapX: 40,
								gapY: 40,
								rotateDeg: 30
							}) {
								this.content()
							}
						}
					}
				}
				ListItem() {
					ComponentShowContainer({ title: 'è‡ªå®šä¹‰é—´éš”', titlePaddingLeft: SPACE.XS }) {
						IBestWatermark({
							text: $r("app.string.app_name"),
							gapX: 80,
							gapY: 80
						}) {
							this.content()
						}
					}
				}
				ListItem() {
					ComponentShowContainer({ title: 'è‡ªå®šä¹‰å€¾æ–œè§’åº¦', titlePaddingLeft: SPACE.XS }) {
						IBestWatermark({
							text: $r("app.string.app_name"),
							fontSize: 14,
							gapX: 20,
							gapY: 20,
							rotateDeg: 0
						}) {
							this.content()
						}
					}
				}
				ListItem() {
					ComponentShowContainer({ title: 'è‡ªå®šä¹‰å±‚çº§', titlePaddingLeft: SPACE.XS }) {
						IBestWatermark({
							text: $r("app.string.app_name"),
							gapX: 40,
							gapY: 40,
							waterMarkZIndex: 1
						}) {
							this.content()
						}
					}
				}
			}
			.layoutWeight(1)
			.padding({ bottom: SPACE.SM })
		}
		.width(CONTAINER_SIZE.FULL)
		.height(CONTAINER_SIZE.FULL)
		.backgroundColor(modeColor.bg)
	}
}
```

è¿è¡Œä¸‹demoï¼Œçœ‹ä¸‹demoä½¿ç”¨æ•ˆæœ

![](https://cdn.nlark.com/yuque/0/2025/png/26122809/1742733661438-fd9dd72a-9080-43ef-91af-5f7fb6394f29.png)![](https://cdn.nlark.com/yuque/0/2025/png/26122809/1742733696403-73a6df0a-02bf-4fa9-a63b-2bcda932f55a.png)

# å››ã€æºç è§£æ
## <font style="color:rgb(60, 60, 67);">å¿«é€Ÿæ‰¾åˆ°æºä»£ç ä½ç½®</font>
å¯ä»¥é€šè¿‡å¿«æ·æ–¹å¼ `Ctrl+Shift+N` è½¬åˆ°æ–‡ä»¶ï¼Œè¾“å…¥è‡ªå·±æ‰€æƒ³æ‰¾åˆ°çš„æ–‡ä»¶

![](https://cdn.nlark.com/yuque/0/2025/png/26122809/1742732410818-ff52aaaa-76d1-40a1-a98b-b70c400feab4.png)

æ ¹æ®å‰é¢çš„ç›®å½•ç»“æ„ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“äº†entryæ˜¯æ ·ä¾‹æ–‡ä»¶ï¼Œlibraryæ˜¯ç»„ä»¶åº“æ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦æ‰¾çš„æ–‡ä»¶ï¼Œå°±æ˜¯åœ¨ <font style="color:rgb(60, 60, 67);"> </font>`<font style="color:rgb(255, 80, 44);background-color:rgb(255, 245, 245);">library\src\main\ets\components\watermark</font>`é‡Œ

è¿›åˆ°æ–‡ä»¶é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸‰ä¸ªæ–‡ä»¶

![](https://cdn.nlark.com/yuque/0/2025/png/26122809/1742733781014-fd8e9c8c-9679-4ba4-bb8b-325fb2cbcd40.png)

color.estæ–‡ä»¶å®šä¹‰äº†ç›¸å…³æ ·å¼ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œåœ¨ `<font style="color:rgb(255, 80, 44);background-color:rgb(255, 245, 245);">library\src\main\resources\base\element\color.json</font>` è¯»å–æ ·å¼ï¼Œå¥½å¤„ç†å…¨å±€æ ·å¼

```javascript
interface IBestWatermarkColorType {
    bgColor: ResourceColor
}

export const IBestWatermarkColor: IBestWatermarkColorType = {
    bgColor: $r("app.color.ibest_water_mark_background")
}
```

### index.estä»£ç è§£é‡Š
æ¥ä¸‹æ¥å°±çœ‹ä¸‹ä¸»æ–‡ä»¶<font style="color:rgb(255, 80, 44);background-color:rgb(255, 245, 245);">index.est</font>ï¼ˆå·²æ·»åŠ ç›¸å…³æ³¨é‡Šï¼‰

```javascript
/**
 * å¯¼å…¥å¿…è¦çš„ç±»å‹å’Œå·¥å…·å‡½æ•°
 */
import { IBestStringNumber } from '../../model/Global.type'
import { getDefaultBaseStyle, IBEST_UI_NAMESPACE } from '../../theme-chalk/src'
import { IBestUIBaseStyleObjType } from '../../theme-chalk/src/index.type'
import { IBestWatermarkColor } from './color'
import { WatermarkCanvas } from './watermarkCanvas'

/**
 * å®šä¹‰ä¸€ä¸ªæ°´å°ç»„ä»¶ï¼Œæ”¯æŒå›¾ç‰‡æ°´å°å’Œæ–‡å­—æ°´å°
 */
@Component
export struct IBestWatermark {
    /**
     * å…¨å±€å…¬å…±æ ·å¼ï¼Œä»å­˜å‚¨ä¸­åŠ è½½é»˜è®¤ä¸»é¢˜æ ·å¼
     */
    @StorageLink(IBEST_UI_NAMESPACE) baseStyle: IBestUIBaseStyleObjType = getDefaultBaseStyle()
    /**
     * é»˜è®¤çš„æ’æ§½å†…å®¹ï¼Œç”¨äºæ”¾ç½®ç”¨æˆ·è‡ªå®šä¹‰çš„å†…å®¹
     */
    @BuilderParam defaultSlot?: CustomBuilder
    /**
     * å›¾ç‰‡æ°´å°çš„å®½åº¦
     */
    @Prop waterMarkWidth: number
    /**
     * å›¾ç‰‡æ°´å°çš„é«˜åº¦
     */
    @Prop waterMarkHeight: number
    /**
     * æ°´å°é€æ˜åº¦ï¼Œé»˜è®¤å€¼ä¸º0.3
     */
    @Prop waterMarkOpacity: number = 0.3
    /**
     * æ°´å°ä¹‹é—´çš„æ°´å¹³é—´éš”ï¼Œé»˜è®¤å€¼ä¸º0
     */
    @Prop gapX: number
    /**
     * æ°´å°ä¹‹é—´çš„å‚ç›´é—´éš”ï¼Œé»˜è®¤å€¼ä¸º0
     */
    @Prop gapY: number
    /**
     * æ°´å°æ—‹è½¬è§’åº¦
     */
    @Prop rotateDeg: number
    /**
     * å›¾ç‰‡æ°´å°çš„é“¾æ¥
     */
    @Prop imageUrl: ResourceStr
    /**
     * æ–‡å­—æ°´å°å†…å®¹
     */
    @Prop text: ResourceStr
    /**
     * æ–‡å­—æ°´å°çš„å­—ä½“å¤§å°
     */
    @Prop fontSize: number
    /**
     * æ–‡å­—æ°´å°çš„å­—ä½“ç±»å‹
     */
    @Prop fontFamily: string
    /**
     * æ–‡å­—æ°´å°çš„é¢œè‰²ï¼Œæ”¯æŒæ¸å˜æˆ–å›¾æ¡ˆ
     */
    @Prop fontColor: IBestStringNumber | CanvasGradient | CanvasPattern
    /**
     * æ°´å°çš„z-indexï¼Œé»˜è®¤å€¼ä¸º-1ï¼ˆåœ¨èƒŒæ™¯å±‚ï¼‰
     */
    @Prop waterMarkZIndex: number = -1
    /**
     * èƒŒæ™¯è‰²ï¼Œé»˜è®¤ä¸ºç©º
     * @since 2.0.1
     */
    @Prop bgColor: ResourceColor = ""
    /**
     * æ°´å°åŒºåŸŸçš„æ€»é«˜åº¦ï¼ŒåŠ¨æ€è®¡ç®—
     */
    @State waterMarkContainHeight: number = 0
    /**
     * æ°´å°åŒºåŸŸçš„æ€»å®½åº¦ï¼ŒåŠ¨æ€è®¡ç®—
     */
    @State waterMarkContainWidth: number = 0
    /**
     * æ°´å°å›¾ç‰‡çš„URLï¼Œç”±WatermarkCanvasç”Ÿæˆ
     */
    @State url: string = ''
    /**
     * å®šä¹‰æ°´å°å†…å®¹çš„æ„å»ºå™¨
     */
    @Builder watermarkContent() {
        Image(this.url)
            .width(this.waterMarkContainWidth) // è®¾ç½®æ°´å°å›¾ç‰‡å®½åº¦
            .height(this.waterMarkContainHeight) // è®¾ç½®æ°´å°å›¾ç‰‡é«˜åº¦
            .opacity(this.waterMarkOpacity) // è®¾ç½®æ°´å°é€æ˜åº¦
    }
    /**
     * è·å–èƒŒæ™¯è‰²ï¼Œä¼˜å…ˆä½¿ç”¨ç”¨æˆ·å®šä¹‰çš„bgColorï¼Œå¦åˆ™ä½¿ç”¨é»˜è®¤å€¼
     */
    getBgColor(): ResourceColor {
        return this.bgColor || IBestWatermarkColor.bgColor
    }
    /**
     * æ„å»ºç»„ä»¶UI
     */
    build() {
        Stack() { // ä½¿ç”¨Stackå¸ƒå±€å®¹å™¨
            WatermarkCanvas({ // è°ƒç”¨WatermarkCanvasç”Ÿæˆæ°´å°å›¾ç‰‡
                waterMarkContainHeight: this.waterMarkContainHeight, // æ°´å°åŒºåŸŸé«˜åº¦
                waterMarkContainWidth: this.waterMarkContainWidth, // æ°´å°åŒºåŸŸå®½åº¦
                waterMarkHeight: this.waterMarkHeight, // å•ä¸ªæ°´å°é«˜åº¦
                waterMarkWidth: this.waterMarkWidth, // å•ä¸ªæ°´å°å®½åº¦
                fontFamily: this.fontFamily, // å­—ä½“ç±»å‹
                rotateDeg: this.rotateDeg, // æ—‹è½¬è§’åº¦
                fontColor: this.fontColor, // å­—ä½“é¢œè‰²
                imageUrl: this.imageUrl, // å›¾ç‰‡æ°´å°é“¾æ¥
                fontSize: this.fontSize, // å­—ä½“å¤§å°
                gapY: this.gapY, // å‚ç›´é—´éš”
                gapX: this.gapX, // æ°´å¹³é—´éš”
                text: this.text, // æ–‡å­—æ°´å°å†…å®¹
                onComplete: (url: string) => { // æ°´å°ç”Ÿæˆå®Œæˆåçš„å›è°ƒ
                    this.url = url // æ›´æ–°æ°´å°å›¾ç‰‡URL
                }
            })

            if (this.waterMarkZIndex <= 0) { // å¦‚æœz-indexå°äºç­‰äº0ï¼Œå°†æ°´å°æ”¾åœ¨èƒŒæ™¯å±‚
                this.watermarkContent()
            }

            Column() { // å®šä¹‰ä¸€ä¸ªColumnå®¹å™¨ï¼Œç”¨äºæ”¾ç½®é»˜è®¤æ’æ§½å†…å®¹
                if (this.defaultSlot) { // å¦‚æœå­˜åœ¨é»˜è®¤æ’æ§½å†…å®¹ï¼Œåˆ™æ¸²æŸ“
                    this.defaultSlot()
                }
            }
            .onAreaChange((oldValue: Area, newValue: Area) => { // ç›‘å¬åŒºåŸŸå˜åŒ–ï¼ŒåŠ¨æ€æ›´æ–°æ°´å°åŒºåŸŸå°ºå¯¸
                this.waterMarkContainHeight = newValue.height as number
                this.waterMarkContainWidth = newValue.width as number
            })

            if (this.waterMarkZIndex > 0) { // å¦‚æœz-indexå¤§äº0ï¼Œå°†æ°´å°æ”¾åœ¨å‰æ™¯å±‚
                this.watermarkContent()
            }
        }
        .backgroundColor(this.getBgColor()) // è®¾ç½®èƒŒæ™¯è‰²
    }
}
```

ä»¥ä¸‹æ˜¯å¯¹`IBestWatermark`ç»„ä»¶çš„è¯¦ç»†è§£é‡Šï¼Œåˆ†ä¸ºå‡ ä¸ªä¸»è¦éƒ¨åˆ†è¿›è¡Œè¯´æ˜ï¼š

#### **1. å¯¼å…¥æ¨¡å—**
```arkts
import { IBestStringNumber } from '../../model/Global.type'
import { getDefaultBaseStyle, IBEST_UI_NAMESPACE } from '../../theme-chalk/src'
import { IBestUIBaseStyleObjType } from '../../theme-chalk/src/index.type'
import { IBestWatermarkColor } from './color'
import { WatermarkCanvas } from './watermarkCanvas'
```

+ **åŠŸèƒ½**ï¼šå¯¼å…¥äº†å¿…è¦çš„ç±»å‹å’Œå·¥å…·å‡½æ•°ã€‚
    - `IBestStringNumber`ï¼šå®šä¹‰äº†ä¸€ç§æ”¯æŒå­—ç¬¦ä¸²æˆ–æ•°å­—çš„ç±»å‹ã€‚
    - `getDefaultBaseStyle` å’Œ `IBEST_UI_NAMESPACE`ï¼šç”¨äºåŠ è½½å…¨å±€ä¸»é¢˜æ ·å¼ã€‚
    - `IBestWatermarkColor`ï¼šå®šä¹‰äº†æ°´å°ç»„ä»¶çš„é¢œè‰²ç›¸å…³é…ç½®ã€‚
    - `WatermarkCanvas`ï¼šè´Ÿè´£ç”Ÿæˆæ°´å°å›¾ç‰‡çš„æ ¸å¿ƒç»„ä»¶ã€‚

#### **2. å±æ€§å®šä¹‰**
ä»¥ä¸‹æ˜¯`IBestWatermark`ç»„ä»¶ä¸­å®šä¹‰çš„å±æ€§åŠå…¶ä½œç”¨ï¼š

| å±æ€§å | ç±»å‹ | é»˜è®¤å€¼ | æè¿° |
| --- | --- | --- | --- |
| `baseStyle` | `IBestUIBaseStyleObjType` |  | å…¨å±€å…¬å…±æ ·å¼ï¼Œä»å­˜å‚¨ä¸­åŠ è½½é»˜è®¤ä¸»é¢˜æ ·å¼ã€‚ |
| `defaultSlot` | `CustomBuilder` |  | é»˜è®¤æ’æ§½å†…å®¹ï¼Œç”¨äºæ”¾ç½®ç”¨æˆ·è‡ªå®šä¹‰çš„å†…å®¹ã€‚ |
| `waterMarkWidth` | `number` |  | å›¾ç‰‡æ°´å°çš„å®½åº¦ã€‚ |
| `waterMarkHeight` | `number` |  | å›¾ç‰‡æ°´å°çš„é«˜åº¦ã€‚ |
| `waterMarkOpacity` | `number` | `0.3` | æ°´å°é€æ˜åº¦ï¼Œé»˜è®¤å€¼ä¸º`0.3`ã€‚ |
| `gapX` | `number` |  | æ°´å°ä¹‹é—´çš„æ°´å¹³é—´éš”ï¼Œé»˜è®¤å€¼ä¸º`0`ã€‚ |
| `gapY` | `number` |  | æ°´å°ä¹‹é—´çš„å‚ç›´é—´éš”ï¼Œé»˜è®¤å€¼ä¸º`0`ã€‚ |
| `rotateDeg` | `number` |  | æ°´å°æ—‹è½¬è§’åº¦ã€‚ |
| `imageUrl` | `ResourceStr` |  | å›¾ç‰‡æ°´å°çš„é“¾æ¥ã€‚ |
| `text` | `ResourceStr` |  | æ–‡å­—æ°´å°å†…å®¹ã€‚ |
| `fontSize` | `number` |  | æ–‡å­—æ°´å°çš„å­—ä½“å¤§å°ã€‚ |
| `fontFamily` | `string` |  | æ–‡å­—æ°´å°çš„å­—ä½“ç±»å‹ã€‚ |
| `fontColor` | `IBestStringNumber | CanvasGradient | CanvasPattern` |
| `waterMarkZIndex` | `number` | `-1` | æ°´å°çš„z-indexï¼Œé»˜è®¤å€¼ä¸º`-1`ï¼ˆåœ¨èƒŒæ™¯å±‚ï¼‰ã€‚ |
| `bgColor` | `ResourceColor` | `""` | èƒŒæ™¯è‰²ï¼Œé»˜è®¤ä¸ºç©ºã€‚ |
| `waterMarkContainHeight` | `number` | `0` | æ°´å°åŒºåŸŸçš„æ€»é«˜åº¦ï¼ŒåŠ¨æ€è®¡ç®—ã€‚ |
| `waterMarkContainWidth` | `number` | `0` | æ°´å°åŒºåŸŸçš„æ€»å®½åº¦ï¼ŒåŠ¨æ€è®¡ç®—ã€‚ |
| `url` | `string` | `''` | æ°´å°å›¾ç‰‡çš„URLï¼Œç”±`WatermarkCanvas`ç”Ÿæˆã€‚ |


#### **4. æ–¹æ³•å®šä¹‰**
##### **(1) **`watermarkContent`
```arkts
@Builder watermarkContent() {
    Image(this.url)
        .width(this.waterMarkContainWidth)
        .height(this.waterMarkContainHeight)
        .opacity(this.waterMarkOpacity)
}
```

+ **åŠŸèƒ½**ï¼šå®šä¹‰æ°´å°å†…å®¹çš„æ„å»ºå™¨ã€‚
+ **é€»è¾‘**ï¼š
    - ä½¿ç”¨`Image`ç»„ä»¶åŠ è½½æ°´å°å›¾ç‰‡`this.url`ã€‚
    - è®¾ç½®æ°´å°å›¾ç‰‡çš„å®½åº¦ã€é«˜åº¦å’Œé€æ˜åº¦ã€‚

#### **5. æ„å»ºUI (**`build`**æ–¹æ³•)**
```arkts
build() {
    Stack() { 
        WatermarkCanvas({ 
            waterMarkContainHeight: this.waterMarkContainHeight,
            waterMarkContainWidth: this.waterMarkContainWidth,
            waterMarkHeight: this.waterMarkHeight,
            waterMarkWidth: this.waterMarkWidth,
            fontFamily: this.fontFamily,
            rotateDeg: this.rotateDeg,
            fontColor: this.fontColor,
            imageUrl: this.imageUrl,
            fontSize: this.fontSize,
            gapY: this.gapY,
            gapX: this.gapX,
            text: this.text,
            onComplete: (url: string) => { 
                this.url = url 
            }
        })

        if (this.waterMarkZIndex <= 0) { 
            this.watermarkContent()
        }

        Column() { 
            if (this.defaultSlot) { 
                this.defaultSlot()
            }
        }
        .onAreaChange((oldValue: Area, newValue: Area) => { 
            this.waterMarkContainHeight = newValue.height as number
            this.waterMarkContainWidth = newValue.width as number
        })

        if (this.waterMarkZIndex > 0) { 
            this.watermarkContent()
        }
    }
    .backgroundColor(this.getBgColor())
}
```

+ **åŠŸèƒ½**ï¼šæ„å»ºç»„ä»¶çš„UIå¸ƒå±€ã€‚
+ **é€»è¾‘**ï¼š
    1. **Stackå¸ƒå±€å®¹å™¨**ï¼š
        * ä½¿ç”¨`Stack`ä½œä¸ºæ ¹å®¹å™¨ã€‚
    2. **è°ƒç”¨**`WatermarkCanvas`**ç”Ÿæˆæ°´å°å›¾ç‰‡**ï¼š
        * å°†æ‰€æœ‰æ°´å°ç›¸å…³çš„å±æ€§ä¼ é€’ç»™`WatermarkCanvas`ã€‚
        * <font style="color:#DF2A3F;">å½“æ°´å°ç”Ÿæˆå®Œæˆåï¼Œé€šè¿‡</font>`<font style="color:#DF2A3F;">onComplete</font>`<font style="color:#DF2A3F;">å›è°ƒæ›´æ–°</font>`<font style="color:#DF2A3F;">this.url</font>`<font style="color:#DF2A3F;">ã€‚</font>
    3. **æ ¹æ®**`z-index`**å†³å®šæ°´å°ä½ç½®**ï¼š
        * å¦‚æœ`z-index <= 0`ï¼Œå°†æ°´å°æ”¾åœ¨èƒŒæ™¯å±‚ã€‚
        * å¦‚æœ`z-index > 0`ï¼Œå°†æ°´å°æ”¾åœ¨å‰æ™¯å±‚ã€‚
    4. **Columnå®¹å™¨**ï¼š
        * å®šä¹‰ä¸€ä¸ª`Column`å®¹å™¨ï¼Œç”¨äºæ”¾ç½®é»˜è®¤æ’æ§½å†…å®¹ã€‚
        * <font style="color:#DF2A3F;">ç›‘å¬åŒºåŸŸå˜åŒ–äº‹ä»¶ï¼ŒåŠ¨æ€æ›´æ–°æ°´å°åŒºåŸŸçš„å®½åº¦å’Œé«˜åº¦</font>ã€‚
    5. **è®¾ç½®èƒŒæ™¯è‰²**ï¼š
        * è°ƒç”¨`getBgColor`æ–¹æ³•è®¾ç½®èƒŒæ™¯è‰²ã€‚

![](https://cdn.nlark.com/yuque/__mermaid_v3/ccf229f124ca4880aa035a398198f1ab.svg)

![](https://cdn.nlark.com/yuque/0/2025/png/26122809/1742993324324-fd34ec48-90e1-4375-afbe-e1874c960568.png)

#### **6. æ€»ç»“**
+ **æ ¸å¿ƒåŠŸèƒ½**ï¼š`IBestWatermark`ç»„ä»¶å®ç°äº†çµæ´»çš„æ°´å°åŠŸèƒ½ï¼Œæ”¯æŒå›¾ç‰‡æ°´å°å’Œæ–‡å­—æ°´å°ï¼Œå¹¶å…è®¸ç”¨æˆ·è‡ªå®šä¹‰æ°´å°çš„æ ·å¼ã€ä½ç½®å’Œé€æ˜åº¦ã€‚
+ **åŠ¨æ€ç‰¹æ€§**ï¼šé€šè¿‡ç›‘å¬åŒºåŸŸå˜åŒ–äº‹ä»¶ï¼ŒåŠ¨æ€è°ƒæ•´æ°´å°åŒºåŸŸçš„å°ºå¯¸ã€‚
+ **æ‰©å±•æ€§**ï¼šæ”¯æŒé€šè¿‡æ’æ§½æ’å…¥ç”¨æˆ·è‡ªå®šä¹‰å†…å®¹ï¼Œå¢å¼ºäº†ç»„ä»¶çš„çµæ´»æ€§å’Œå¯å¤ç”¨æ€§ã€‚

### WatermarkCanvas.estä»£ç ä»‹ç»
æ¥ä¸‹æ¥å°±çœ‹ä¸‹æ–‡ä»¶<font style="color:rgb(255, 80, 44);background-color:rgb(255, 245, 245);">WatermarkCanvas.est</font>ï¼ˆå·²æ·»åŠ ç›¸å…³æ³¨é‡Šï¼‰

```javascript
import { IBestStringNumber } from '../../model/Global.type'
import GlobalStore from '../../utils/GlobalStore'
import { base64ToPixelMap, getResourceStr } from '../../utils/utils'

interface DrawCanvasItemArgs {
    height: number,
    width: number,
    rotateDeg: number,
    callback: () => void
}
interface CountData {
    countX: number,
    countY: number
}
/**
 * WatermarkCanvasç»„ä»¶ç”¨äºç”Ÿæˆå’Œç®¡ç†æ°´å°çš„ç»˜åˆ¶
 */
@Component
export struct WatermarkCanvas {
  @StorageProp("IBestColorMode") @Watch("drawWaterMark") colorMode: ColorMode = ColorMode.LIGHT
  settings: RenderingContextSettings = new RenderingContextSettings(true)
  context: CanvasRenderingContext2D = new CanvasRenderingContext2D(this.settings)
  /**
   * å›¾ç‰‡æ°´å°çš„å®½åº¦
   */
  @Prop @Watch('drawWaterMark') waterMarkWidth: number = 100
  /**
   * å›¾ç‰‡æ°´å°çš„é«˜åº¦
   */
  @Prop @Watch('drawWaterMark') waterMarkHeight: number = 100
  /**
   * æ°´å°é€æ˜åº¦
   */
  @Prop waterMarkOpacity: number = 0.3
  /**
   * æ—‹è½¬è§’åº¦
   */
  @Prop @Watch('drawWaterMark') rotateDeg: number = -22
  /**
   * æ°´å°åŒºåŸŸçš„æ€»é«˜åº¦
   */
  @Prop @Watch('drawWaterMark') waterMarkContainHeight: number = 0
  /**
   * æ°´å°åŒºåŸŸçš„æ€»å®½åº¦
   */
  @Prop @Watch('drawWaterMark') waterMarkContainWidth: number = 0
  /**
   * æ°´å°ä¹‹é—´çš„æ°´å¹³é—´éš” é»˜è®¤0
   */
  @Prop @Watch('drawWaterMark') gapX: number = 0
  /**
   * æ°´å°ä¹‹é—´çš„å‚ç›´é—´éš” é»˜è®¤0
   */
  @Prop @Watch('drawWaterMark') gapY: number = 0
  /**
   * å›¾ç‰‡æ°´å°çš„é“¾æ¥
   */
  @Prop @Watch('drawWaterMark') imageUrl: ResourceStr = ''
  /**
   * æ–‡å­—æ°´å°çš„æ–‡æ¡ˆ æ–‡å­—æ°´å°ä¼˜å…ˆçº§é«˜äºå›¾ç‰‡æ°´å°
   */
  @Prop @Watch('drawWaterMark') text: ResourceStr = ''
  /**
   * æ–‡å­—çš„å¤§å°
   */
  @Prop @Watch('drawWaterMark') fontSize: number = 14
  /**
   * æ–‡å­—å­—ä½“
   */
  @Prop @Watch('drawWaterMark') fontFamily: string = 'sans-serif'
  /**
   * æ–‡å­—é¢œè‰²
   */
  @Prop @Watch('drawWaterMark') fontColor: IBestStringNumber | CanvasGradient | CanvasPattern = ''
  /**
   * ç»˜åˆ¶å®Œæˆå›è°ƒ
   */
  onComplete: (url: string) => void = () => {}
  private resourceManager = GlobalStore.context.resourceManager
  /**
   * è·å–æ–‡å­—é¢œè‰²ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œåˆ™æ ¹æ®colorModeé€‰æ‹©é»˜è®¤é¢œè‰²
   * @returns {string} é¢œè‰²å€¼
   */
  getFontColor() {
      return this.fontColor || (this.colorMode == 0 ? "#f5f5f5" : "#323232")
  }
  /**
   * è·å–æ–‡å­—æ°´å°çš„æ–‡æ¡ˆ
   * @returns {string} æ–‡æ¡ˆ
   */
  getText(){
      return getResourceStr(this.text)
  }
  // æ¸…é™¤ç”»å¸ƒ
  clearCanvas() {
      this.context?.clearRect(0, 0, this.waterMarkWidth, this.waterMarkHeight)
  }
  /**
   * è·å–xè½´ä¸yè½´çš„ç»˜åˆ¶æ•°é‡
   * @param width æ¯ä¸ªæ°´å°çš„å®½åº¦
   * @param height æ¯ä¸ªæ°´å°çš„é«˜åº¦
   * @returns {CountData} åŒ…å«xè½´å’Œyè½´çš„ç»˜åˆ¶æ•°é‡
   */
  getXYCount(width: number, height: number) {
      // è®¡ç®—å‡ºæ°´å¹³æ•°é‡
      let countX = Math.ceil(this.waterMarkContainWidth / (width + this.gapX))
      // ä¿è¯æœ€å°‘æœ‰ä¸€ä¸ª
      if (countX <= 0) {
          countX = 1
      }
      // è®¡ç®—å‡ºå‚ç›´æ•°é‡
      let countY = Math.ceil(this.waterMarkContainHeight / (height + this.gapY))
      // ä¿è¯æœ€å°‘æœ‰ä¸€ä¸ª
      if (countY <= 0) {
          countY = 1
      }
      // é¿å…å› ä¸ºæ—‹è½¬å¯¼è‡´æœ‰éƒ¨åˆ†ç•™ç™½ æ‰€ä»¥å¤šæ¸²æŸ“ç‚¹
      countY = countY + 2
      countX = countX + 2
      const countData: CountData = {
          countX,
          countY
      }
      return countData
  }
  /**
   * åˆ›å»ºçŸ©é˜µç»˜åˆ¶canvas
   * @param {number} width æ¯ä¸ªç»˜åˆ¶å—çš„å®½åº¦
   * @param {number} height æ¯ä¸ªç»˜åˆ¶å—çš„é«˜åº¦
   * @param {number} rotateDeg æ—‹è½¬çš„è§’åº¦
   * @param {()=>void} callback æ¯æ¬¡ç»˜åˆ¶çš„å†…å®¹
   */
  drawCanvasItem(data: DrawCanvasItemArgs) {
      const width = data.width
      const height = data.height
      const rotateDeg = data.rotateDeg
      const callback = data.callback
      const countData = this.getXYCount(width, height)
      const countX = countData.countX
      const countY = countData.countY
      // æ ¹æ®è®¡ç®—å‡ºçš„æ•°é‡åˆ›å»ºçŸ©é˜µ
      // iæ˜¯Yè½´
      for (let i = 0; i < countY; i++) {
          // jæ˜¯Xè½´
          for (let j = 0; j < countX; j++) {
              const x = width * j + this.gapX * j
              const y = height * i + this.gapY * i
              this.context.save()
              this.context.translate(x, y)
              this.context.rotate(rotateDeg)
              callback()
              // è¿˜åŸä¹‹å‰ä¿å­˜çš„çŠ¶æ€
              this.context.restore()
          }
      }
      let url: string = this.context.toDataURL("png")
      if (url != "data:image/png") {
          this.onComplete(url)
      }
  }
  /**
   * ç»˜åˆ¶å›¾ç‰‡æ°´å°
   * @param {number} rotateDeg æ—‹è½¬çš„è§’åº¦
   */
  async handleLayoutImg(rotateDeg: number) {
      let imgModel: PixelMap | ImageBitmap
      if (typeof this.imageUrl == 'string') {
          if(this.imageUrl.startsWith("data:image")){ // base64
              imgModel = await base64ToPixelMap(this.imageUrl)
          } else { // æœ¬åœ°é€‰æ‹©çš„å›¾ç‰‡ ç½‘ç»œå›¾ç‰‡
              imgModel = new ImageBitmap(this.imageUrl)
          }
      } else {	// Resource
          imgModel = await base64ToPixelMap(this.resourceManager.getMediaContentBase64Sync(this.imageUrl))
      }
      this.drawCanvasItem({
          width: this.waterMarkWidth,
          height: this.waterMarkHeight,
          rotateDeg,
          callback: () => {
              this.context.drawImage(imgModel, 0, 0, this.waterMarkWidth, this.waterMarkHeight)
          }
      })
  }
  /**
   * ç»˜åˆ¶æ–‡å­—æ°´å°
   * @param {number} rotateDeg æ—‹è½¬çš„è§’åº¦
   */
  handleLayoutText(rotateDeg: number) {
      let text = this.getText()
      this.context.fillStyle = this.getFontColor()
      this.context.font = `${vp2px(this.fontSize)}px ${this.fontFamily}`
      const data = this.context.measureText(text)
      this.drawCanvasItem({
          width: data.width,
          height: data.height,
          rotateDeg,
          callback: () => {
              this.context.fillText(text, 0, 0)
          }
      })
  }
  /**
   * ç»˜åˆ¶æ°´å°
   */
  drawWaterMark() {
      this.clearCanvas()
      this.context.textBaseline = 'top'
      const rotateDeg = this.rotateDeg * Math.PI / 180
      if(this.text){
          this.handleLayoutText(rotateDeg)
      }else if(this.imageUrl){
          this.handleLayoutImg(rotateDeg)
      }
  }
  /**
   * æ„å»ºCanvasç»„ä»¶
   */
  build() {
      Canvas(this.context)
          .width(this.waterMarkContainWidth)
          .height(this.waterMarkContainHeight)
          .onReady(() => {
              this.drawWaterMark()
          })
          .opacity(0)
          .enabled(false)
  }
}
```

ä»¥ä¸‹æ˜¯`WatermarkCanvas`ç»„ä»¶çš„è¯¦ç»†è§£é‡Šï¼Œåˆ†ä¸ºå‡ ä¸ªä¸»è¦éƒ¨åˆ†è¿›è¡Œè¯´æ˜ï¼š

#### **1. å¯¼å…¥æ¨¡å—**
```arkts
import { IBestStringNumber } from '../../model/Global.type'
import GlobalStore from '../../utils/GlobalStore'
import { base64ToPixelMap, getResourceStr } from '../../utils/utils'
```

+ **åŠŸèƒ½**ï¼šå¯¼å…¥äº†å¿…è¦çš„ç±»å‹å’Œå·¥å…·å‡½æ•°ã€‚
    - `IBestStringNumber`ï¼šå®šä¹‰äº†ä¸€ç§æ”¯æŒå­—ç¬¦ä¸²æˆ–æ•°å­—çš„ç±»å‹ã€‚
    - `GlobalStore`ï¼šç”¨äºè®¿é—®å…¨å±€å­˜å‚¨ã€‚
    - `base64ToPixelMap` å’Œ `getResourceStr`ï¼šå·¥å…·å‡½æ•°ï¼Œåˆ†åˆ«ç”¨äºå°†Base64å­—ç¬¦ä¸²è½¬æ¢ä¸ºåƒç´ æ˜ å°„å’Œè·å–èµ„æºå­—ç¬¦ä¸²ã€‚

---

#### **2. å®šä¹‰æ¥å£**
```arkts
interface DrawCanvasItemArgs {
    height: number,
    width: number,
    rotateDeg: number,
    callback: () => void
}
interface CountData {
    countX: number,
    countY: number
}
```

+ **åŠŸèƒ½**ï¼šå®šä¹‰äº†ä¸¤ä¸ªæ¥å£ï¼Œç”¨äºç±»å‹æ£€æŸ¥ã€‚
    - `DrawCanvasItemArgs`ï¼šç”¨äºä¼ é€’ç»˜åˆ¶å•ä¸ªæ°´å°å—çš„å‚æ•°ã€‚
    - `CountData`ï¼šç”¨äºå­˜å‚¨è®¡ç®—å‡ºçš„æ°´å¹³å’Œå‚ç›´æ–¹å‘ä¸Šçš„æ°´å°æ•°é‡ã€‚

#### **3. å®šä¹‰**`WatermarkCanvas`**ç»„ä»¶**
```arkts
/**
 * WatermarkCanvasç»„ä»¶ç”¨äºç”Ÿæˆå’Œç®¡ç†æ°´å°çš„ç»˜åˆ¶
 */
@Component
export struct WatermarkCanvas {
    ...
}
```

+ **åŠŸèƒ½**ï¼šå®šä¹‰äº†ä¸€ä¸ªåä¸º`WatermarkCanvas`çš„ç»„ä»¶ï¼Œè´Ÿè´£ç”Ÿæˆå’Œç®¡ç†æ°´å°çš„ç»˜åˆ¶ã€‚

#### **4. å±æ€§å®šä¹‰**
![](https://cdn.nlark.com/yuque/0/2025/png/26122809/1742994180169-366b41d2-5f88-4a1e-b2ab-9505af7256a8.png)

ä»¥ä¸‹æ˜¯`WatermarkCanvas`ç»„ä»¶ä¸­å®šä¹‰çš„å±æ€§åŠå…¶ä½œç”¨ï¼š

| å±æ€§å | ç±»å‹ | é»˜è®¤å€¼ | æè¿° |
| --- | --- | --- | --- |
| `colorMode` | `ColorMode` | `ColorMode.LIGHT` | å…¨å±€é¢œè‰²æ¨¡å¼ï¼Œä»å­˜å‚¨ä¸­åŠ è½½ã€‚ |
| `settings` | `RenderingContextSettings` |  | æ¸²æŸ“ä¸Šä¸‹æ–‡è®¾ç½®ã€‚ |
| `context` | `CanvasRenderingContext2D` |  | 2Dç”»å¸ƒæ¸²æŸ“ä¸Šä¸‹æ–‡ã€‚ |
| `waterMarkWidth` | `number` | `100` | å›¾ç‰‡æ°´å°çš„å®½åº¦ã€‚ |
| `waterMarkHeight` | `number` | `100` | å›¾ç‰‡æ°´å°çš„é«˜åº¦ã€‚ |
| `waterMarkOpacity` | `number` | `0.3` | æ°´å°é€æ˜åº¦ï¼Œé»˜è®¤å€¼ä¸º`0.3`ã€‚ |
| `rotateDeg` | `number` | `-22` | æ°´å°æ—‹è½¬è§’åº¦ã€‚ |
| `waterMarkContainHeight` | `number` | `0` | æ°´å°åŒºåŸŸçš„æ€»é«˜åº¦ã€‚ |
| `waterMarkContainWidth` | `number` | `0` | æ°´å°åŒºåŸŸçš„æ€»å®½åº¦ã€‚ |
| `gapX` | `number` | `0` | æ°´å°ä¹‹é—´çš„æ°´å¹³é—´éš”ï¼Œé»˜è®¤å€¼ä¸º`0`ã€‚ |
| `gapY` | `number` | `0` | æ°´å°ä¹‹é—´çš„å‚ç›´é—´éš”ï¼Œé»˜è®¤å€¼ä¸º`0`ã€‚ |
| `imageUrl` | `ResourceStr` | `''` | å›¾ç‰‡æ°´å°çš„é“¾æ¥ã€‚ |
| `text` | `ResourceStr` | `''` | æ–‡å­—æ°´å°å†…å®¹ã€‚ |
| `fontSize` | `number` | `14` | æ–‡å­—æ°´å°çš„å­—ä½“å¤§å°ã€‚ |
| `fontFamily` | `string` | `'sans-serif'` | æ–‡å­—æ°´å°çš„å­—ä½“ç±»å‹ã€‚ |
| `fontColor` | `IBestStringNumber | CanvasGradient | CanvasPattern` |
| `onComplete` | `(url: string) => void` | `() => {}` | æ°´å°ç”Ÿæˆå®Œæˆåçš„å›è°ƒå‡½æ•°ã€‚ |
| `resourceManager` | `GlobalStore.context.resourceManager` |  | èµ„æºç®¡ç†å™¨ï¼Œç”¨äºè·å–èµ„æºå†…å®¹ã€‚ |


#### **5. æ–¹æ³•å®šä¹‰**
##### **(1) **`getFontColor`
```arkts
/**
 * è·å–æ–‡å­—é¢œè‰²ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œåˆ™æ ¹æ®colorModeé€‰æ‹©é»˜è®¤é¢œè‰²
 * @returns {string} é¢œè‰²å€¼
 */
getFontColor() {
    return this.fontColor || (this.colorMode == 0 ? "#f5f5f5" : "#323232")
}
```

+ **åŠŸèƒ½**ï¼šè·å–æ–‡å­—é¢œè‰²ã€‚
+ **é€»è¾‘**ï¼š
    - å¦‚æœ`fontColor`å·²è®¾ç½®ï¼Œåˆ™è¿”å›`fontColor`ã€‚
    - å¦åˆ™æ ¹æ®`colorMode`é€‰æ‹©é»˜è®¤é¢œè‰²ï¼š
        * `colorMode == 0`ï¼šè¿”å›`#f5f5f5`ã€‚
        * å¦åˆ™è¿”å›`#323232`ã€‚

##### **(2) **`getText`
```arkts
/**
 * è·å–æ–‡å­—æ°´å°çš„æ–‡æ¡ˆ
 * @returns {string} æ–‡æ¡ˆ
 */
getText(){
    return getResourceStr(this.text)
}
```

+ **åŠŸèƒ½**ï¼šè·å–æ–‡å­—æ°´å°çš„æ–‡æ¡ˆã€‚
+ **é€»è¾‘**ï¼š
    - è°ƒç”¨`getResourceStr`å‡½æ•°è·å–èµ„æºå­—ç¬¦ä¸²`this.text`ã€‚

##### **(3) **`clearCanvas`
```arkts
// æ¸…é™¤ç”»å¸ƒ
clearCanvas() {
    this.context?.clearRect(0, 0, this.waterMarkWidth, this.waterMarkHeight)
}
```

+ **åŠŸèƒ½**ï¼šæ¸…é™¤ç”»å¸ƒä¸Šçš„å†…å®¹ã€‚
+ **é€»è¾‘**ï¼š
    - ä½¿ç”¨`clearRect`æ–¹æ³•æ¸…é™¤æŒ‡å®šåŒºåŸŸçš„å†…å®¹ã€‚

##### **(4) **`getXYCount`
```arkts
/**
 * è·å–xè½´ä¸yè½´çš„ç»˜åˆ¶æ•°é‡
 * @param width æ¯ä¸ªæ°´å°çš„å®½åº¦
 * @param height æ¯ä¸ªæ°´å°çš„é«˜åº¦
 * @returns {CountData} åŒ…å«xè½´å’Œyè½´çš„ç»˜åˆ¶æ•°é‡
 */
getXYCount(width: number, height: number) {
    // è®¡ç®—å‡ºæ°´å¹³æ•°é‡
    let countX = Math.ceil(this.waterMarkContainWidth / (width + this.gapX))
    // ä¿è¯æœ€å°‘æœ‰ä¸€ä¸ª
    if (countX <= 0) {
        countX = 1
    }
    // è®¡ç®—å‡ºå‚ç›´æ•°é‡
    let countY = Math.ceil(this.waterMarkContainHeight / (height + this.gapY))
    // ä¿è¯æœ€å°‘æœ‰ä¸€ä¸ª
    if (countY <= 0) {
        countY = 1
    }
    // é¿å…å› ä¸ºæ—‹è½¬å¯¼è‡´æœ‰éƒ¨åˆ†ç•™ç™½ æ‰€ä»¥å¤šæ¸²æŸ“ç‚¹
    countY = countY + 2
    countX = countX + 2
    const countData: CountData = {
        countX,
        countY
    }
    return countData
}
```

+ **åŠŸèƒ½**ï¼šè®¡ç®—åœ¨ç»™å®šåŒºåŸŸå†…ç»˜åˆ¶æ°´å°æ‰€éœ€çš„æ°´å¹³å’Œå‚ç›´æ•°é‡ã€‚
+ **é€»è¾‘**ï¼š
    1. **è®¡ç®—æ°´å¹³æ•°é‡ (**`countX`**)**ï¼š
        * æ ¹æ®`waterMarkContainWidth`ã€`width`å’Œ`gapX`è®¡ç®—æ°´å¹³æ–¹å‘ä¸Šçš„æ°´å°æ•°é‡ã€‚
        * ç¡®ä¿è‡³å°‘æœ‰ä¸€ä¸ªæ°´å°ã€‚
    2. **è®¡ç®—å‚ç›´æ•°é‡ (**`countY`**)**ï¼š
        * æ ¹æ®`waterMarkContainHeight`ã€`height`å’Œ`gapY`è®¡ç®—å‚ç›´æ–¹å‘ä¸Šçš„æ°´å°æ•°é‡ã€‚
        * ç¡®ä¿è‡³å°‘æœ‰ä¸€ä¸ªæ°´å°ã€‚
    3. **é¿å…ç•™ç™½**ï¼š
        * ä¸ºäº†é˜²æ­¢æ—‹è½¬å¯¼è‡´çš„éƒ¨åˆ†ç•™ç™½ï¼Œå¢åŠ `countY`å’Œ`countX`å„2ä¸ªå•ä½ã€‚
    4. **è¿”å›ç»“æœ**ï¼š
        * è¿”å›åŒ…å«`countX`å’Œ`countY`çš„å¯¹è±¡ã€‚

##### **(5) **`drawCanvasItem`
```arkts
/**
 * åˆ›å»ºçŸ©é˜µç»˜åˆ¶canvas
 * @param {number} width æ¯ä¸ªç»˜åˆ¶å—çš„å®½åº¦
 * @param {number} height æ¯ä¸ªç»˜åˆ¶å—çš„é«˜åº¦
 * @param {number} rotateDeg æ—‹è½¬çš„è§’åº¦
 * @param {()=>void} callback æ¯æ¬¡ç»˜åˆ¶çš„å†…å®¹
 */
drawCanvasItem(data: DrawCanvasItemArgs) {
    const width = data.width
    const height = data.height
    const rotateDeg = data.rotateDeg
    const callback = data.callback
    const countData = this.getXYCount(width, height)
    const countX = countData.countX
    const countY = countData.countY
    // æ ¹æ®è®¡ç®—å‡ºçš„æ•°é‡åˆ›å»ºçŸ©é˜µ
    // iæ˜¯Yè½´
    for (let i = 0; i < countY; i++) {
        // jæ˜¯Xè½´
        for (let j = 0; j < countX; j++) {
            const x = width * j + this.gapX * j
            const y = height * i + this.gapY * i
            this.context.save()
            this.context.translate(x, y)
            this.context.rotate(rotateDeg)
            callback()
            // è¿˜åŸä¹‹å‰ä¿å­˜çš„çŠ¶æ€
            this.context.restore()
        }
    }
    let url: string = this.context.toDataURL("png")
    if (url != "data:image/png") {
        this.onComplete(url)
    }
}
```

+ **åŠŸèƒ½**ï¼šåœ¨ç”»å¸ƒä¸Šç»˜åˆ¶å¤šä¸ªæ°´å°å—ã€‚
+ **é€»è¾‘**ï¼š
    1. **è·å–å‚æ•°**ï¼š
        * ä»`data`å¯¹è±¡ä¸­æå–`width`ã€`height`ã€`rotateDeg`å’Œ`callback`ã€‚
    2. **è®¡ç®—ç»˜åˆ¶æ•°é‡**ï¼š
        * è°ƒç”¨`getXYCount`æ–¹æ³•è·å–æ°´å¹³å’Œå‚ç›´æ–¹å‘ä¸Šçš„ç»˜åˆ¶æ•°é‡`countX`å’Œ`countY`ã€‚
    3. **ç»˜åˆ¶çŸ©é˜µ**ï¼š
        * ä½¿ç”¨åµŒå¥—çš„`for`å¾ªç¯éå†æ¯ä¸ªæ°´å°å—çš„ä½ç½®ã€‚
        * è®¡ç®—æ¯ä¸ªæ°´å°å—çš„`x`å’Œ`y`åæ ‡ã€‚
        * ä¿å­˜å½“å‰çš„æ¸²æŸ“çŠ¶æ€ã€‚
        * å¹³ç§»å’Œæ—‹è½¬ç”»å¸ƒåˆ°æŒ‡å®šä½ç½®ã€‚
        * è°ƒç”¨`callback`å‡½æ•°æ‰§è¡Œå…·ä½“çš„ç»˜åˆ¶æ“ä½œã€‚
        * è¿˜åŸä¹‹å‰çš„æ¸²æŸ“çŠ¶æ€ã€‚
    4. **ç”Ÿæˆæ•°æ®URL**ï¼š
        * å°†ç»˜åˆ¶å¥½çš„ç”»å¸ƒå†…å®¹è½¬æ¢ä¸ºPNGæ ¼å¼çš„æ•°æ®URLã€‚
        * å¦‚æœç”Ÿæˆçš„URLä¸æ˜¯é»˜è®¤çš„`data:image/png`ï¼Œåˆ™è°ƒç”¨`onComplete`å›è°ƒå‡½æ•°å¹¶ä¼ é€’ç”Ÿæˆçš„URLã€‚

##### **(6) **`handleLayoutImg`
```arkts
/**
 * ç»˜åˆ¶å›¾ç‰‡æ°´å°
 * @param {number} rotateDeg æ—‹è½¬çš„è§’åº¦
 */
async handleLayoutImg(rotateDeg: number) {
    let imgModel: PixelMap | ImageBitmap
    if (typeof this.imageUrl == 'string') {
        if(this.imageUrl.startsWith("data:image")){ // base64
            imgModel = await base64ToPixelMap(this.imageUrl)
        } else { // æœ¬åœ°é€‰æ‹©çš„å›¾ç‰‡ ç½‘ç»œå›¾ç‰‡
            imgModel = new ImageBitmap(this.imageUrl)
        }
    } else {	// Resource
        imgModel = await base64ToPixelMap(this.resourceManager.getMediaContentBase64Sync(this.imageUrl))
    }
    this.drawCanvasItem({
        width: this.waterMarkWidth,
        height: this.waterMarkHeight,
        rotateDeg,
        callback: () => {
            this.context.drawImage(imgModel, 0, 0, this.waterMarkWidth, this.waterMarkHeight)
        }
    })
}
```

+ **åŠŸèƒ½**ï¼šç»˜åˆ¶å›¾ç‰‡æ°´å°ã€‚
+ **é€»è¾‘**ï¼š
    1. **åŠ è½½å›¾ç‰‡æ¨¡å‹**ï¼š
        * æ ¹æ®`imageUrl`çš„ç±»å‹åŠ è½½å›¾ç‰‡æ¨¡å‹ã€‚
        * å¦‚æœ`imageUrl`æ˜¯å­—ç¬¦ä¸²ï¼š
            + å¦‚æœä»¥`data:image`å¼€å¤´ï¼Œè°ƒç”¨`base64ToPixelMap`å°†Base64å­—ç¬¦ä¸²è½¬æ¢ä¸º`PixelMap`ã€‚
            + å¦åˆ™ï¼Œåˆ›å»º`ImageBitmap`å¯¹è±¡ã€‚
        * å¦‚æœ`imageUrl`æ˜¯èµ„æºå¯¹è±¡ï¼Œè°ƒç”¨`resourceManager.getMediaContentBase64Sync`è·å–Base64å­—ç¬¦ä¸²ï¼Œå†è½¬æ¢ä¸º`PixelMap`ã€‚
    2. **ç»˜åˆ¶å›¾ç‰‡**ï¼š
        * è°ƒç”¨`drawCanvasItem`æ–¹æ³•ï¼Œä¼ é€’å›¾ç‰‡çš„å®½åº¦ã€é«˜åº¦ã€æ—‹è½¬è§’åº¦å’Œç»˜åˆ¶å›è°ƒå‡½æ•°ã€‚
        * åœ¨å›è°ƒå‡½æ•°ä¸­ï¼Œä½¿ç”¨`drawImage`æ–¹æ³•åœ¨æŒ‡å®šä½ç½®ç»˜åˆ¶å›¾ç‰‡ã€‚

##### **(7) **`handleLayoutText`
```arkts
/**
 * ç»˜åˆ¶æ–‡å­—æ°´å°
 * @param {number} rotateDeg æ—‹è½¬çš„è§’åº¦
 */
handleLayoutText(rotateDeg: number) {
    let text = this.getText()
    this.context.fillStyle = this.getFontColor()
    this.context.font = `${vp2px(this.fontSize)}px ${this.fontFamily}`
    const data = this.context.measureText(text)
    this.drawCanvasItem({
        width: data.width,
        height: data.height,
        rotateDeg,
        callback: () => {
            this.context.fillText(text, 0, 0)
        }
    })
}
```

+ **åŠŸèƒ½**ï¼šç»˜åˆ¶æ–‡å­—æ°´å°ã€‚
+ **é€»è¾‘**ï¼š
    1. **è·å–æ–‡å­—å’Œé¢œè‰²**ï¼š
        * è°ƒç”¨`getText`æ–¹æ³•è·å–æ–‡å­—å†…å®¹ã€‚
        * è°ƒç”¨`getFontColor`æ–¹æ³•è·å–æ–‡å­—é¢œè‰²ã€‚
    2. **è®¾ç½®å­—ä½“æ ·å¼**ï¼š
        * è®¾ç½®`fillStyle`ä¸ºæ–‡å­—é¢œè‰²ã€‚
        * è®¾ç½®`font`å±æ€§ä¸ºå­—ä½“å¤§å°å’Œå­—ä½“ç±»å‹ã€‚
    3. **æµ‹é‡æ–‡å­—å®½åº¦**ï¼š
        * ä½¿ç”¨`measureText`æ–¹æ³•æµ‹é‡æ–‡å­—çš„å®½åº¦ã€‚
    4. **ç»˜åˆ¶æ–‡å­—**ï¼š
        * è°ƒç”¨`drawCanvasItem`æ–¹æ³•ï¼Œä¼ é€’æ–‡å­—çš„å®½åº¦ã€é«˜åº¦ã€æ—‹è½¬è§’åº¦å’Œç»˜åˆ¶å›è°ƒå‡½æ•°ã€‚
        * åœ¨å›è°ƒå‡½æ•°ä¸­ï¼Œä½¿ç”¨`fillText`æ–¹æ³•åœ¨æŒ‡å®šä½ç½®ç»˜åˆ¶æ–‡å­—ã€‚

##### **(8) **`drawWaterMark`
```arkts
/**
 * ç»˜åˆ¶æ°´å°
 */
drawWaterMark() {
    this.clearCanvas()
    this.context.textBaseline = 'top'
    const rotateDeg = this.rotateDeg * Math.PI / 180
    if(this.text){
        this.handleLayoutText(rotateDeg)
    }else if(this.imageUrl){
        this.handleLayoutImg(rotateDeg)
    }
}
```

+ **åŠŸèƒ½**ï¼šæ ¹æ®é…ç½®ç»˜åˆ¶æ°´å°ã€‚
+ **é€»è¾‘**ï¼š
    1. **æ¸…é™¤ç”»å¸ƒ**ï¼š
        * è°ƒç”¨`clearCanvas`æ–¹æ³•æ¸…é™¤ç”»å¸ƒä¸Šçš„å†…å®¹ã€‚
    2. **è®¾ç½®æ–‡æœ¬åŸºçº¿**ï¼š
        * è®¾ç½®`textBaseline`ä¸º`'top'`ï¼Œç¡®ä¿æ–‡å­—ä»é¡¶éƒ¨å¯¹é½ã€‚
    3. **è½¬æ¢æ—‹è½¬è§’åº¦**ï¼š
        * å°†`rotateDeg`ä»åº¦æ•°è½¬æ¢ä¸ºå¼§åº¦ã€‚
    4. **ç»˜åˆ¶æ°´å°**ï¼š
        * å¦‚æœ`text`å±æ€§å­˜åœ¨ï¼Œè°ƒç”¨`handleLayoutText`æ–¹æ³•ç»˜åˆ¶æ–‡å­—æ°´å°ã€‚
        * å¦åˆ™å¦‚æœ`imageUrl`å±æ€§å­˜åœ¨ï¼Œè°ƒç”¨`handleLayoutImg`æ–¹æ³•ç»˜åˆ¶å›¾ç‰‡æ°´å°ã€‚

##### **(9) **`build`
```arkts
/**
 * æ„å»ºCanvasç»„ä»¶
 */
build() {
    Canvas(this.context)
        .width(this.waterMarkContainWidth)
        .height(this.waterMarkContainHeight)
        .onReady(() => {
            this.drawWaterMark()
        })
        .opacity(0)
        .enabled(false)
}
```

+ **åŠŸèƒ½**ï¼šæ„å»ºCanvasç»„ä»¶å¹¶è®¾ç½®å…¶å±æ€§ã€‚
+ **é€»è¾‘**ï¼š
    1. **åˆ›å»ºCanvasç»„ä»¶**ï¼š
        * ä½¿ç”¨`Canvas`ç»„ä»¶å¹¶ä¼ å…¥`context`ã€‚
    2. **è®¾ç½®å®½åº¦å’Œé«˜åº¦**ï¼š
        * è®¾ç½®Canvasçš„å®½åº¦ä¸º`waterMarkContainWidth`ã€‚
        * è®¾ç½®Canvasçš„é«˜åº¦ä¸º`waterMarkContainHeight`ã€‚
    3. **è®¾ç½®å°±ç»ªå›è°ƒ**ï¼š
        * åœ¨Canvaså‡†å¤‡å¥½åï¼Œè°ƒç”¨`drawWaterMark`æ–¹æ³•ç»˜åˆ¶æ°´å°ã€‚
    4. **è®¾ç½®é€æ˜åº¦å’Œå¯ç”¨çŠ¶æ€**ï¼š
        * è®¾ç½®Canvasçš„é€æ˜åº¦ä¸º`0`ï¼Œä½¿å…¶ä¸å¯è§ã€‚
        * è®¾ç½®Canvasçš„å¯ç”¨çŠ¶æ€ä¸º`false`ï¼Œä½¿å…¶ä¸å¯äº¤äº’ã€‚

#### 6. æµç¨‹å›¾
![](https://cdn.nlark.com/yuque/__mermaid_v3/e911fc6e2dd2599bee2f766ad33924e8.svg)

![](https://cdn.nlark.com/yuque/0/2025/svg/26122809/1742995308408-ea62616d-4d17-4670-8bc1-a1344a473ce0.svg)

![](https://cdn.nlark.com/yuque/0/2025/png/26122809/1743089622594-048ef03d-f860-4209-abb0-fa195ff1a42d.png)

#### **7. æ€»ç»“**
+ **æ ¸å¿ƒåŠŸèƒ½**ï¼š`WatermarkCanvas`ç»„ä»¶è´Ÿè´£ç”Ÿæˆå’Œç®¡ç†æ°´å°çš„ç»˜åˆ¶ï¼Œæ”¯æŒå›¾ç‰‡æ°´å°å’Œæ–‡å­—æ°´å°ã€‚
+ **åŠ¨æ€ç‰¹æ€§**ï¼šæ ¹æ®ä¼ å…¥çš„å±æ€§åŠ¨æ€è®¡ç®—æ°´å°çš„æ•°é‡å’Œä½ç½®ï¼Œå¹¶æ”¯æŒæ—‹è½¬å’Œé€æ˜åº¦è®¾ç½®ã€‚
+ **æ‰©å±•æ€§**ï¼šé€šè¿‡å›è°ƒå‡½æ•°`onComplete`ï¼Œå…è®¸å¤–éƒ¨å¤„ç†ç”Ÿæˆçš„æ°´å°å›¾ç‰‡ã€‚

# äº”. æ€»ç»“
### **å¿«é€Ÿå›é¡¾ï¼šWatermark ç»„ä»¶æ ¸å¿ƒäº®ç‚¹**
1. **åŠ¨æ€æ¸²æŸ“å¼•æ“**  
    - é€šè¿‡ `Canvas` å®ç°æ–‡å­—/å›¾ç‰‡æ°´å°çš„çŸ©é˜µæ’åˆ—ï¼Œæ”¯æŒæ—‹è½¬ã€é€æ˜åº¦ã€é—´éš”åŠ¨æ€è°ƒèŠ‚ã€‚  
    - è‡ªåŠ¨é€‚é…å®¹å™¨å°ºå¯¸å˜åŒ–ï¼ˆ`onAreaChange` ç›‘å¬ï¼‰ï¼Œå®æ—¶æ›´æ–°å¸ƒå±€ã€‚
2. **ä¸»é¢˜ä¸èµ„æºå…¼å®¹**  
    - æ·±æµ…æ¨¡å¼è‡ªåŠ¨åˆ‡æ¢æ°´å°é¢œè‰²ï¼Œå…¼å®¹æœ¬åœ°èµ„æºã€ç½‘ç»œå›¾ç‰‡ã€Base64 æ ¼å¼ã€‚  
    - é€šè¿‡ `@StorageLink` å®æ—¶å“åº”å…¨å±€ä¸»é¢˜å˜æ›´ã€‚
3. **æ€§èƒ½ä¼˜åŒ–è®¾è®¡**  
    - ä»…åœ¨ `Canvas` å°±ç»ªåç»˜åˆ¶ï¼ˆ`onReady`ï¼‰ï¼Œé¿å…ç™½å±ã€‚  
    - é€šè¿‡ `toDataURL` ç”Ÿæˆé™æ€å›¾ç‰‡ï¼Œå‡å°‘é‡å¤ç»˜åˆ¶å¼€é”€ã€‚
4. **å¼€å‘è€…å‹å¥½**  
    - å±æ€§é©±åŠ¨é…ç½®ï¼ˆ`gapX`/`gapY`/`rotateDeg`ï¼‰ï¼Œæ”¯æŒæ’æ§½åµŒå…¥è‡ªå®šä¹‰å†…å®¹ã€‚  
    - æºç æ¨¡å—åŒ–æ¸…æ™°ï¼ˆ`WatermarkCanvas` è´Ÿè´£ç»˜åˆ¶é€»è¾‘ï¼Œ`IBestWatermark` è´Ÿè´£ UI ç»„åˆï¼‰ã€‚

**ä¸€å¥è¯æ€»ç»“**ï¼šIBest-UI çš„ Watermark ç»„ä»¶é€šè¿‡å£°æ˜å¼ API å’Œ Canvas é«˜æ•ˆæ¸²æŸ“ï¼Œä¸ºé¸¿è’™å¼€å‘è€…æä¾›äº†â€œé›¶è´Ÿæ‹…â€çš„æ°´å°è§£å†³æ–¹æ¡ˆï¼Œæ˜¯å­¦ä¹  ArkTS è¿›é˜¶æŠ€å·§çš„ä¼˜è´¨æ¡ˆä¾‹ã€‚



#### 
